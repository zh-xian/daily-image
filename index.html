<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>每日一图 - 留存世间奇景</title>
    <link rel="icon" href="/favicon.ico" type="image/x-icon" />
    <link
      rel="stylesheet"
      href="https://fontsapi.zeoseven.com/488/main/result.css"
    />
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family: Tahoma, Geneva, Verdana,
          sans-serif;
        color: #e0e0e0;
        background-color: #121212;
        line-height: 1.6;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      /* 悬浮菜单 */
      .floating-menu {
        position: fixed;
        top: 20px;
        left: 20px;
        z-index: 1001;
        display: flex;
        background: rgba(30, 30, 30, 0.8);
        backdrop-filter: blur(10px);
        border-radius: 30px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        transition: all 0.3s ease;
        overflow: hidden;
      }
      .floating-menu::after {
        content: "";
        width: 15px;
        border-radius: 30px;
      }
    
      .menu-item {
        display: flex;
        align-items: center;
        padding: 5px 10px;
        color: #e0e0e0;
        text-decoration: none;
        font-size: 0.9rem;
      }

      .menu-item:hover {
        color: #fff;
        border-bottom: 1px solid #fff;
      }
      .menu-icon {
        width: 22px;
        height: 22px;
        border-radius: 50%;
      }
      @media (max-width: 500px) {
        .floating-menu {
          display: none;
        }
      }

      /* Hero Section */
      .hero {
        position: relative;
        width: 100%;
        height: 100vh;
        overflow: hidden;
      }
      .hero img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      .hero:hover img {
        transform: scale(1.02);
      }
      .hero .overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          to top,
          rgba(0, 0, 0, 0.8),
          transparent 40%
        );
        display: flex;
        flex-direction: column;
        justify-content: flex-end;
        padding: 40px;
        color: #fff;
      }
      .hero .center-text {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        text-align: center;
        width: 100%;
      }
      .hero .center-text h1 {
        font-size: 3rem;
        font-weight: 300;
        margin-bottom: 15px;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.8);
      }
      .hero .center-text p {
        font-size: 1.2rem;
        max-width: 600px;
        margin: 0 auto;
        text-shadow: 0 2px 6px rgba(0, 0, 0, 0.8);
      }
      .hero .overlay .date {
        font-size: 2rem;
        margin-bottom: 10px;
        font-weight: 300;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
      }
      .hero .overlay .copy {
        font-size: 1.2rem;
        max-width: 1000px;
        font-weight: 300;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
      }

      /* 一言样式 */
      .yiyan {
        background: #1e1e1e;
        color: #e0e0e0;
        padding: 40px 0 20px 0;
        text-align: center;
        font-size: 1.2rem;
        line-height: 1.8;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        position: relative;
      }
      
      .yiyan-content {
        max-width: 800px;
        margin: 0 auto;
        font-weight: 300;
        position: relative;
        padding: 20px 20px;
        margin: 0 20px;
      }

      /* 添加左上角和右下角的直角装饰 */
      .yiyan-content::before,
      .yiyan-content::after {
        content: '';
        position: absolute;
        width: 20px;
        height: 20px;
        border-color: rgba(255, 255, 255, 0.3);
        border-style: solid;
      }

      .yiyan-content::before {
        top: 0;
        left: 0;
        border-width: 2px 0 0 2px;
      }

      .yiyan-content::after {
        bottom: 0;
        right: 0;
        border-width: 0 2px 2px 0;
      }
      
      .yiyan-loading {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top-color: #fff;
        animation: spin 1s ease-in-out infinite;
      }

      /* .yiyan-signature {
        width: 760px;
        max-width: 100%;
        text-align: right;
        padding: 20px 0;
      } */
      
      @keyframes spin {
        to { transform: rotate(360deg); }
      }

      /* History Grid */
      .history-container {
        padding: 40px 20px;
        background: #1e1e1e;
        flex: 1;
      }
      .history {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        margin: 0 auto;
        max-width: 1200px;
      }

      @media (max-width: 1200px) {
        .history {
          grid-template-columns: repeat(2, 1fr);
        }
      }

      @media (max-width: 768px) {
        .history {
          grid-template-columns: 1fr;
        }
      }

      /* 图片加载过渡效果 */
      .img-loading {
        filter: blur(20px);
        opacity: 0;
        transform: scale(1.1);
        transition: filter 0.8s ease, opacity 0.8s ease, transform 0.8s ease;
        background: #2d2d2d;
      }

      .img-loading.img-loaded {
        filter: blur(0);
        opacity: 1;
        transform: scale(1);
      }

      .card {
        position: relative;
        border-radius: 8px;
        overflow: hidden;
        background: #000;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        transition: all 0.3s ease;
        cursor: pointer;
      }
      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
      }
      .card img {
        width: 100%;
        height: 250px;
        object-fit: cover;
        display: block;
        transition: transform 0.5s ease;
      }
      .card:hover img {
        transform: scale(1.05);
      }
      .card .date-label {
        position: absolute;
        bottom: 15px;
        left: 15px;
        background: rgba(0, 0, 0, 0.7);
        color: #fff;
        padding: 5px 10px;
        border-radius: 20px;
        font-size: 0.8rem;
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: all 0.3s ease;
      }
      .card .copy-text {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        padding: 15px;
        background: linear-gradient(to top, rgba(0, 0, 0, 0.9), transparent);
        color: #fff;
        font-size: 0.9rem;
        text-align: center;
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.3s ease;
      }
      .card:hover .date-label {
        opacity: 0;
        transform: translateY(10px);
      }
      .card:hover .copy-text {
        opacity: 1;
        transform: translateY(0);
      }

      /* 更新后的Modal样式 */
      .modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(30, 30, 30, 0);
        backdrop-filter: blur(0);
        z-index: 1000;
        display: none; /* 初始隐藏 */
        align-items: center;
        justify-content: center;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease, visibility 0.3s ease, background 0.3s ease, backdrop-filter 0.3s ease;
      }

      .modal.active {
        opacity: 1;
        visibility: visible;
        background: rgba(30, 30, 30, 0.9);
        backdrop-filter: blur(10px);
      }

      .modal-content {
        max-width: 90%;
        max-height: 90%;
        transform: scale(0.95);
        transition: transform 0.3s ease, opacity 0.3s ease;
        opacity: 0;
      }

      .modal.active .modal-content {
        transform: scale(1);
        opacity: 1;
      }

      .modal-img-container {
        position: relative;
        max-width: 100%;
        max-height: 80vh;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
      }

      .modal-img {
        max-width: 100%;
        max-height: 80vh;
        object-fit: contain;
        display: block;
      }

      .modal-caption {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        padding: 30px 20px 20px;
        background: linear-gradient(to top, rgba(0, 0, 0, 0.9), transparent);
        color: #fff;
        text-align: center;
        transform: translateY(100%);
        opacity: 0;
        transition: all 0.3s ease;
      }

      .modal-img-container:hover .modal-caption {
        transform: translateY(0);
        opacity: 1;
      }

      .modal-close {
        position: absolute;
        top: 30px;
        right: 30px;
        color: #fff;
        font-size: 2rem;
        cursor: pointer;
        background: none;
        border: none;
        transition: transform 0.3s ease;
        opacity: 0.7;
      }

      .modal-close:hover {
        transform: rotate(90deg);
        opacity: 1;
      }

      /* 页脚样式 */
      footer {
        background: #1a1a1a;
        color: #aaa;
        padding: 30px 15px;
        text-align: center;
        font-size: 0.9rem;
      }
      footer a {
        color: #e0e0e0;
        text-decoration: none;
        transition: color 0.2s ease;
      }
      footer a:hover {
        color: #fff;
        text-decoration: underline;
      }
      footer div {
        margin-bottom: 10px;
      }
      #vercount_value_site_pv,
      #vercount_value_site_uv {
        font-weight: bold;
        color: #e0e0e0;
      }
    </style>
  </head>
  <body>
    <!-- 悬浮菜单 -->
    <nav class="floating-menu">
      <a href="/" style="display: flex; align-items: center; margin: 0 5px 0 5px">
        <img src="favicon.ico" alt="Icon" class="menu-icon" />
      </a>
      <a href="https://blog.zhxiansec.cn/" class="menu-item" target="_blank"
        >站长博客</a
      >
      <a href="https://zhxiansec.cn/" class="menu-item" target="_blank"
        >个人主页</a
      >
      <a href="/api" class="menu-item" target="_blank"
        >接口文档</a
      >
      <a
        href="https://github.com/willow-god/daily-image"
        class="menu-item"
        target="_blank"
        >项目地址</a
      >
    </nav>

    <div class="hero">
      <img
        id="hero-img" 
        class="img-loading" 
        src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjMmQyZDJkIi8+PC9zdmc+"
        alt="Today's Bing Wallpaper"
      />
      <div class="overlay">
        <div class="center-text">
          <h1>Bing每日一图</h1>
          <p>腾讯EO强力支持，实现每日一图接口，保存最近30天内的bing壁纸</p>
        </div>
        <div class="date" id="hero-date"></div>
        <div class="copy" id="hero-copy"></div>
      </div>
    </div>

    <div class="yiyan">
      <div class="yiyan-content">
        <span class="yiyan-loading"></span>
      </div>
      <div class="yiyan-signature">----送给素不相识的陌生人----</div>
    </div>

    <div class="history-container">
      <div class="history" id="history"></div>
    </div>

    <!-- 页脚 -->
    <footer>
      <!-- <script defer src="https://cn.vercount.one/js"></script>

      <div style="margin-bottom: 0.5em">
        网站总请求量：<span id="vercount_value_site_pv">🤕</span> |
        独立访客数：<span id="vercount_value_site_uv">🤕</span>
      </div>

      <div style="margin-bottom: 0.5em">
        本站已运行：<span id="running-days">计算中...</span> |
        距离下次更新：<span id="next-update">计算中...</span>
      </div> -->

      <div style="margin-bottom: 0.5em">
        Powered by
        <a
          href="https://github.com/features/actions"
          target="_blank"
          rel="nofollow noopener noreferrer"
          >GitHub Actions</a>
        |
        <a href="https://cn.bing.com"
           target="_blank" 
           rel="nofollow noopener noreferrer"
          >Bing_CN</a> 
        |
        <a
          href="https://cloud.tencent.com/product/teo"
          target="_blank"
          rel="nofollow noopener noreferrer"
          >EdgeOne</a>
      </div>

      <!-- <div>
        项目地址:
        <a
          href="https://github.com/willow-god/daily-image"
          target="_blank"
          rel="nofollow noopener noreferrer"
          >daily-image</a>
        | MIT License © <span id="year"></span> |
        <a
          href="https://www.liushen.fun/"
          target="_blank"
          rel="nofollow noopener noreferrer"
          >LiuShen</a>
      </div> -->

      <script>
        // 动态年份显示
        document.getElementById("year").textContent = new Date().getFullYear();
        
        // 计算网站运行时间和下次更新时间
        function updateTimes() {
          // 网站开始运行的日期（请修改为您的网站上线日期）
          const startDate = new Date('2025-4-20'); // 示例日期，请替换为实际上线日期
          const now = new Date();
          
          // 计算已运行天数
          const runningDays = Math.floor((now - startDate) / (1000 * 60 * 60 * 24));
          document.getElementById("running-days").textContent = runningDays + " 天";
          
          // 计算距离下次更新的时间
          const tomorrow = new Date(now);
          tomorrow.setDate(tomorrow.getDate() + (now.getHours() >= 12 ? 1 : 0));
          tomorrow.setHours(12, 0, 0, 0);
          
          // 计算剩余时间
          let diff = tomorrow - now;
          const hours = Math.floor(diff / (1000 * 60 * 60));
          diff -= hours * 1000 * 60 * 60;
          const minutes = Math.floor(diff / (1000 * 60));
          diff -= minutes * 1000 * 60;
          const seconds = Math.floor(diff / 1000);
          
          // 格式化显示
          document.getElementById("next-update").textContent = 
            `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
        
        // 初始更新
        updateTimes();
        
        // 每秒更新一次倒计时
        setInterval(updateTimes, 1000);
      </script>
    </footer>

    <!-- Modal -->
    <div class="modal" id="imageModal">
      <button class="modal-close" id="modalClose">&times;</button>
      <div class="modal-content">
        <div class="modal-img-container">
          <img class="modal-img" id="modalImage" src="" alt="" />
          <div class="modal-caption" id="modalCaption"></div>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // Modal elements
        const modal = document.getElementById("imageModal");
        const modalImage = document.getElementById("modalImage");
        const modalCaption = document.getElementById("modalCaption");
        const modalClose = document.getElementById("modalClose");

        function closeModal() {
          modal.classList.remove("active");
          setTimeout(() => {
            modal.style.display = "none";
          }, 300); // 匹配CSS过渡时间
        }

        function showModal() {
          modal.style.display = "flex";
          // 强制重绘，确保动画运行
          void modal.offsetWidth;
          modal.classList.add("active");
        }

        // Close modal when clicking the close button
        modalClose.addEventListener("click", closeModal);

        // Close modal when clicking outside the image
        modal.addEventListener("click", (e) => {
          if (e.target === modal) {
            closeModal();
          }
        });

        // Close modal with Escape key
        document.addEventListener("keydown", (e) => {
          if (e.key === "Escape" && modal.classList.contains("active")) {
            closeModal();
          }
        });

        // 图片加载函数
        function loadImage(imgElement, src) {
          // imgElement.classList.add("img-loading");
          const loader = new Image();
          loader.src = src;
          loader.onload = () => {
            imgElement.src = src;
            imgElement.classList.add("img-loaded");
          };
          loader.onerror = () => {
            imgElement.classList.remove("img-loading");
            console.error("图片加载失败:", src);
          };
        }

        // 获取一言
        const yiyanContent = document.querySelector('.yiyan-content');
        
        fetch('https://v2.xxapi.cn/api/yiyan?type=hitokoto')
          .then(response => response.json())
          .then(data => {
            if (data.code === 200 && data.data) {
              // 创建淡入效果
              yiyanContent.innerHTML = `<span style="opacity: 0; transition: opacity 1s ease;">${data.data}</span>`;
              
              // 强制重绘后显示文字
              setTimeout(() => {
                const textSpan = yiyanContent.querySelector('span');
                if (textSpan) {
                  textSpan.style.opacity = '1';
                }
              }, 100);
            } else {
              yiyanContent.textContent = '生活，是一场无法回放的电影，我们都是自己的导演。';
            }
          })
          .catch(error => {
            console.error('获取一言失败:', error);
            yiyanContent.textContent = '生活，是一场无法回放的电影，我们都是自己的导演。';
          });

        fetch("/picture/index.json")
          .then((res) => res.json())
            .then((data) => {
            if (!Array.isArray(data) || data.length === 0) {
              console.error("index.json 内容不合法");
              return;
            }

            // 默认将第一张作为今日图
            const today = data[0];
            const heroImg = document.getElementById("hero-img");
            document.getElementById("hero-date").textContent = today.date;
            document.getElementById("hero-copy").textContent = today.copyright;
            loadImage(heroImg, today.path);

            // 其余为历史图
            const historyEl = document.getElementById("history");

            // 逐个添加卡片，带动画
            data.forEach((item, index) => {
              setTimeout(() => {
              const card = document.createElement("div");
              card.className = "card";
              card.style.opacity = "0";
              card.style.transform = "translateY(50px)";
              card.style.transition = "opacity 1.0s cubic-bezier(.4,2,.6,1), transform 1.0s cubic-bezier(.4,2,.6,1)";

              const img = document.createElement("img");
              img.alt = item.date;
              img.className = "img-loading";
              img.src =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjMmQyZDJkIi8+PC9zdmc+";

              const dateLabel = document.createElement("div");
              dateLabel.className = "date-label";
              dateLabel.textContent = item.date;

              const copyText = document.createElement("div");
              copyText.className = "copy-text";
              copyText.textContent = item.copyright;

              card.appendChild(img);
              card.appendChild(dateLabel);
              card.appendChild(copyText);
              historyEl.appendChild(card);

              // 加载实际图片
              loadImage(img, item.path);

              // Add click event to show modal
              card.addEventListener("click", () => {
                modalImage.src = item.path;
                modalCaption.textContent = `${item.date} - ${item.copyright}`;
                showModal();
              });

              // 触发动画
              setTimeout(() => {
                card.style.opacity = "1";
                card.style.transform = "translateY(0)";
              }, 50);
              }, index * 80); // 每个卡片延迟80ms
            });
          })
          .catch((err) => console.error("加载 index.json 失败", err));
      });
    </script>
  </body>
</html>
